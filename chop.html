<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cyber Ops Simulator 4.0</title>
<style>
body {
  font-family: 'Courier New', monospace;
  background-color: #000;
  color: #0f0;
  margin: 0;
  padding: 20px;
}
#terminal {
  border: 2px solid #0f0;
  padding: 10px;
  height: 500px;
  overflow-y: auto;
  background-color: #000;
}
input {
  width: 100%;
  padding: 10px;
  background: #000;
  color: #0f0;
  border: 2px solid #0f0;
  font-family: 'Courier New', monospace;
  font-size: 16px;
}
.stats {
  margin: 10px 0;
}
.code-challenge {
  color: #ff0;
}
</style>
</head>
<body>

<h1>Cyber Ops Simulator 4.0</h1>

<div class="stats"></div>

<div id="terminal"></div>
<input type="text" id="commandInput" placeholder="" autofocus />

<script>
let money = 0;
let btc = 0;
let btcPrice = 1000;
let software = 1;
let security = 50;
let trace = 0;
let terminal = document.getElementById('terminal');
let input = document.getElementById('commandInput');
let currentServer = null;
let mission = null;
let codeChallenge = null;
let codeTimer = null;

let repHackers = 0, repCorps = 0, repLaw = 0;
let inventory = [];
let serverBuffs = {};

let servers = {
  server1: {difficulty: 1, reward: [200, 800]},
  server2: {difficulty: 2, reward: [500, 2000]},
  server3: {difficulty: 3, reward: [1000, 5000]},
  gov: {difficulty: 4, reward: [2000, 7000]},
  bank: {difficulty: 4, reward: [3000, 9000]},
  megacorp: {difficulty: 5, reward: [5000, 15000]},
  military: {difficulty: 6, reward: [10000, 30000]}
};

function updateStats() {
  document.querySelector('.stats').innerHTML = 
    `Money: $${money} | BTC: ${btc} | BTC Price: $${btcPrice} | Software: ${software} | Security: ${security}% | Trace: ${trace}% | Rep(Hackers): ${repHackers} | Rep(Corps): ${repCorps} | Rep(Law): ${repLaw}`;
}

function log(text) {
  terminal.innerHTML += `<p>> ${text}</p>`;
  terminal.scrollTop = terminal.scrollHeight;
}

function checkCaught() {
  if(trace >= 100) {
    log("TRACE LEVEL MAX! You got caught! GAME OVER.");
    input.disabled = true;
    return true;
  }
  if(repLaw >= 100) {
    log("üö® You are now the MOST WANTED hacker in the world! YOU WIN.");
    input.disabled = true;
    return true;
  }
  return false;
}

function randomEvent() {
  let roll = Math.random();
  if(roll < 0.05) {
    let loss = Math.floor(Math.random()*300+100);
    money = Math.max(0, money - loss);
    log(`‚ö† MALWARE ATTACK! You lost $${loss}`);
    security -= 5;
    trace += 10;
    repLaw += 1;
  } else if(roll < 0.08) {
    trace += 15;
    log("‚ö† Police surveillance increased! Trace rising faster.");
    repLaw -= 2;
  } else if(roll < 0.10) {
    btc += 1;
    log("‚úÖ Anonymous group donated 1 BTC to you.");
    repHackers += 2;
  } else if(roll < 0.12) {
    log("ü§´ Insider leaked a backdoor for server3. Success chance doubled for 3 turns.");
    serverBuffs["server3"] = 3;
    repCorps -= 3;
  }
}

function startMission() {
  let missions = [
    "Steal confidential data from server2",
    "Destroy malware hidden in server3",
    "Infiltrate corporation database on server1",
    "Hack government server (gov) for classified files",
    "Drain funds from international bank server (bank)",
    "Steal blueprints from MegaCorp",
    "Infiltrate military server for weapons data"
  ];
  mission = missions[Math.floor(Math.random()*missions.length)];
  log("New Mission: " + mission);
}

function completeMission() {
  if(!mission) return;
  log("üéØ Mission complete! Rewards granted.");
  money += 2000;
  btc += 1;
  security += 5;
  repHackers += 3;
  repCorps -= 3;
  repLaw += 1;
  mission = null;
}

function startCodeChallenge() {
  let chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
  codeChallenge = "";
  for(let i=0; i<4; i++) codeChallenge += chars[Math.floor(Math.random()*chars.length)];
  log(`<span class='code-challenge'>Password crack required! Type: ${codeChallenge} within 10 seconds.</span>`);
  codeTimer = setTimeout(() => {
    log("‚ùå Failed to enter code in time! Trace increased.");
    trace += 20;
    codeChallenge = null;
  }, 10000);
}

function evadeMiniGame() {
  let seq = Math.random().toString(36).substring(2,6).toUpperCase();
  log(`<span class='code-challenge'>TRACE ALERT! Type ${seq} within 3 seconds to reroute signal.</span>`);
  codeChallenge = "EVADE-"+seq;
  codeTimer = setTimeout(() => {
    log("‚ùå Evade failed. Trace continues climbing.");
    codeChallenge = null;
  }, 3000);
}

function executeCommand(cmd) {
  if(checkCaught()) return;

  let parts = cmd.trim().split(" ");
  let action = parts[0].toLowerCase();
  let target = parts.slice(1).join(" ").toLowerCase();

  // Evade / code mini-game
  if(codeChallenge) {
    if(codeChallenge.startsWith("EVADE-")) {
      let seq = codeChallenge.split("-")[1];
      if(cmd.trim().toUpperCase() === seq) {
        clearTimeout(codeTimer);
        log("‚úÖ Evade successful! Trace reduced by 20%");
        trace = Math.max(0, trace-20);
      } else {
        log("‚ùå Wrong sequence. Trace penalty.");
        trace += 10;
      }
      codeChallenge = null;
      updateStats();
      return;
    } else {
      if(cmd.trim().toUpperCase() === codeChallenge) {
        clearTimeout(codeTimer);
        log("‚úÖ Code cracked successfully! Hack succeeded.");
        let gain = Math.floor(Math.random()*3000 + 1000);
        money += gain;
        log(`You gained $${gain}`);
      } else {
        log("‚ùå Wrong code! Trace increased heavily.");
        trace += 30;
      }
      codeChallenge = null;
      updateStats();
      return;
    }
  }

  switch(action) {
    case "help":
      log("Commands: scan, connect [server], hack, upgrade software/security, status, buy [item], sell [item], use [item], mission, darknet, blackmarket, evade, help");
      break;
    case "scan":
      log("Scanning network... Found servers: server1 (easy), server2 (medium), server3 (hard), gov, bank, megacorp, military");
      trace += 5;
      break;
    case "connect":
      if(target && servers[target]) {
        currentServer = target;
        log(`Connected to ${target}. Difficulty: ${servers[target].difficulty}`);
        trace += 5;
      } else {
        log("Specify a valid server. Usage: connect server1");
      }
      break;
    case "hack":
      if(!currentServer) {
        log("Not connected to a server. Use 'connect [server]'");
        break;
      }
      let s = servers[currentServer];
      let buff = serverBuffs[currentServer] ? 2.0 : 1.0;
      if(serverBuffs[currentServer]) {
        serverBuffs[currentServer]--;
        if(serverBuffs[currentServer]<=0) delete serverBuffs[currentServer];
      }
      let chance = (0.75 + 0.25*software - 0.1*s.difficulty) * buff;
      if(inventory.includes("zero-day")) {
        chance = 1.0; // guaranteed success
        inventory.splice(inventory.indexOf("zero-day"), 1);
        log("‚ö° Used Zero-Day Exploit! Guaranteed success.");
      }
      if(chance > Math.random()) {
        if(s.difficulty >= 3 && Math.random() < 0.5) {
          startCodeChallenge(); // mini-game
        } else {
          let gain = Math.floor(Math.random()*(s.reward[1]-s.reward[0]) + s.reward[0]);
          money += gain;
          log(`Hack successful! Gained $${gain}`);
          if(mission && mission.includes(currentServer)) completeMission();
        }
        repHackers += 1; repCorps -= 1;
      } else {
        trace += 15;
        log("Hack failed! Trace increased by 15%");
        repLaw += 1;
      }
      break;
    case "upgrade":
      if(target === "software" && money >= 500) {
        software++;
        money -= 500;
        log("Software upgraded to level " + software);
      } else if(target === "security" && money >= 500) {
        security += 10;
        money -= 500;
        log("Security upgraded! +" + 10 + "%");
      } else {
        log("Not enough money or invalid. Use 'upgrade software' or 'upgrade security'");
      }
      break;
    case "status":
      log(`Money: $${money}, BTC: ${btc}, Software: ${software}, Security: ${security}%, Trace: ${trace}%, Rep(Hackers): ${repHackers}, Rep(Corps): ${repCorps}, Rep(Law): ${repLaw}`);
      log(`Inventory: ${inventory.length > 0 ? inventory.join(", ") : "Empty"}`);
      break;
    case "buy":
      if(target === "btc" && money >= btcPrice) {
        money -= btcPrice;
        btc++;
        log("Bought 1 BTC for $" + btcPrice);
      } else if(target === "malware" && money >= 500) {
        money -= 500;
        inventory.push("malware");
        log("ü¶† Bought a Malware Kit (+hack power on next attempt).");
      } else if(target === "vpn" && money >= 300) {
        money -= 300;
        inventory.push("vpn");
        log("üîê Bought a VPN upgrade (reduces trace gain on next hack).");
      } else if(target === "ransomware" && money >= 1000) {
        money -= 1000;
        inventory.push("ransomware");
        log("üíÄ Bought Ransomware (big one-time payout item).");
      } else if(target === "zero-day" && money >= 1500) {
        money -= 1500;
        inventory.push("zero-day");
        log("‚ö° Bought Zero-Day Exploit (+100% hack success, one use).");
      } else if(target === "rootkit" && money >= 3000) {
        money -= 3000;
        inventory.push("rootkit");
        log("üëæ Bought Rootkit (stealthier hacks, -10 trace per use).");
      } else {
        log("Not enough money or invalid item.");
      }
      break;
    case "sell":
      if(target === "btc" && btc > 0) {
        btc--;
        money += btcPrice;
        log("Sold 1 BTC for $" + btcPrice);
      } else if(target === "data" && inventory.includes("data")) {
        inventory.splice(inventory.indexOf("data"), 1);
        money += 1000;
        log("üìÇ Sold stolen data for $1000.");
      } else {
        log("No such item to sell.");
      }
      break;
    case "use":
      if(target === "malware" && inventory.includes("malware")) {
        inventory.splice(inventory.indexOf("malware"), 1);
        software += 1;
        log("ü¶† Used Malware Kit. Temporary boost: Software +1.");
      } else if(target === "vpn" && inventory.includes("vpn")) {
        inventory.splice(inventory.indexOf("vpn"), 1);
        trace = Math.max(0, trace - 10);
        log("üîê VPN activated. Trace reduced by 10%.");
      } else if(target === "ransomware" && inventory.includes("ransomware")) {
        inventory.splice(inventory.indexOf("ransomware"), 1);
        let gain = 5000;
        money += gain;
        trace += 25;
        log("üíÄ Deployed Ransomware. Gained $" + gain + ", but trace +25%.");
        repLaw += 5;
      } else if(target === "rootkit" && inventory.includes("rootkit")) {
        inventory.splice(inventory.indexOf("rootkit"), 1);
        trace = Math.max(0, trace - 20);
        log("üëæ Rootkit deployed. Trace reduced by 20%.");
      } else {
        log("You don't have that item or it can't be used.");
      }
      break;
    case "mission":
      if(!mission) startMission();
      else log("Current Mission: " + mission);
      break;
    case "darknet":
      log("üï∂ Darknet Shop: sell data, buy malware kits, vpn upgrades.");
      log("Commands: buy malware (500$), buy vpn (300$), sell data (1000$).");
      break;
    case "blackmarket":
      log("üíÄ Black Market: ransomware(1000$), zero-day(1500$), rootkit(3000$).");
      break;
    case "evade":
      if(trace >= 70) {
        evadeMiniGame();
      } else {
        log("Evade not necessary yet. Trace below 70%.");
      }
      break;
    default:
      log("Unknown command. Type 'help' for commands.");
  }

  btcPrice = Math.max(100, btcPrice + Math.floor(Math.random()*200 - 100));
  randomEvent();
  updateStats();
}

input.addEventListener("keydown", function(e) {
  if(e.key === "Enter") {
    executeCommand(input.value);
    input.value = "";
  }
});

log("Welcome, hacker. Type 'help' to see commands.");
updateStats();
</script>

</body>
</html>
